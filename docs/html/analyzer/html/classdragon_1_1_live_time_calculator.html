<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>DRAGON Analyzer: dragon::LiveTimeCalculator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DRAGON Analyzer
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacedragon.html">dragon</a></li><li class="navelem"><a class="el" href="classdragon_1_1_live_time_calculator.html">LiveTimeCalculator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classdragon_1_1_live_time_calculator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">dragon::LiveTimeCalculator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Live time calculator.  
 <a href="classdragon_1_1_live_time_calculator.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_root_analysis_8hxx_source.html">RootAnalysis.hxx</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1750d3e82c9a173d666046173c6bd026"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#a1750d3e82c9a173d666046173c6bd026">LiveTimeCalculator</a> ()</td></tr>
<tr class="memdesc:a1750d3e82c9a173d666046173c6bd026"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty.  <a href="#a1750d3e82c9a173d666046173c6bd026">More...</a><br/></td></tr>
<tr class="separator:a1750d3e82c9a173d666046173c6bd026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74b9d680bccece2ba6b6bb48f01a4a0f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#a74b9d680bccece2ba6b6bb48f01a4a0f">LiveTimeCalculator</a> (TFile *file, Bool_t calculate=kTRUE)</td></tr>
<tr class="memdesc:a74b9d680bccece2ba6b6bb48f01a4a0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize with a run file and perform optional calculation.  <a href="#a74b9d680bccece2ba6b6bb48f01a4a0f">More...</a><br/></td></tr>
<tr class="separator:a74b9d680bccece2ba6b6bb48f01a4a0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2384a2e2f07879c87512f5a87c22de3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#a2384a2e2f07879c87512f5a87c22de3f">Calculate</a> ()</td></tr>
<tr class="memdesc:a2384a2e2f07879c87512f5a87c22de3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform live time calculation across an entire run.  <a href="#a2384a2e2f07879c87512f5a87c22de3f">More...</a><br/></td></tr>
<tr class="separator:a2384a2e2f07879c87512f5a87c22de3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa06012632835e5148ef3a6a0d4d4e585"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#aa06012632835e5148ef3a6a0d4d4e585">CalculateSub</a> (Double_t tbegin, Double_t tend)</td></tr>
<tr class="memdesc:aa06012632835e5148ef3a6a0d4d4e585"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform live time calculation across a subset of the run.  <a href="#aa06012632835e5148ef3a6a0d4d4e585">More...</a><br/></td></tr>
<tr class="separator:aa06012632835e5148ef3a6a0d4d4e585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7830d41ef712838917a5285e22623126"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#a7830d41ef712838917a5285e22623126">CalculateChain</a> (TChain *chain)</td></tr>
<tr class="memdesc:a7830d41ef712838917a5285e22623126"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform live time calculation across a chain of runs.  <a href="#a7830d41ef712838917a5285e22623126">More...</a><br/></td></tr>
<tr class="separator:a7830d41ef712838917a5285e22623126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac987f3280ec8f1856fe7dd576739bfd4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac987f3280ec8f1856fe7dd576739bfd4"></a>
Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#ac987f3280ec8f1856fe7dd576739bfd4">GetBusytime</a> (const char *which) const </td></tr>
<tr class="memdesc:ac987f3280ec8f1856fe7dd576739bfd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the sum of busy times during the run (or subrun) in seconds. <br/></td></tr>
<tr class="separator:ac987f3280ec8f1856fe7dd576739bfd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af047b208c8ea1a4633e2fc7fbe5c6409"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af047b208c8ea1a4633e2fc7fbe5c6409"></a>
Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#af047b208c8ea1a4633e2fc7fbe5c6409">GetRuntime</a> (const char *which) const </td></tr>
<tr class="memdesc:af047b208c8ea1a4633e2fc7fbe5c6409"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the run time in seconds. <br/></td></tr>
<tr class="separator:af047b208c8ea1a4633e2fc7fbe5c6409"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad062068040d9581c206d36f88464346"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aad062068040d9581c206d36f88464346"></a>
Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#aad062068040d9581c206d36f88464346">GetLivetime</a> (const char *which) const </td></tr>
<tr class="memdesc:aad062068040d9581c206d36f88464346"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the live time fraction. <br/></td></tr>
<tr class="separator:aad062068040d9581c206d36f88464346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac11a1655db2f65fa1ab8d1fb7d5fd653"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#ac11a1655db2f65fa1ab8d1fb7d5fd653">GetLivetimeError</a> (const char *which) const </td></tr>
<tr class="memdesc:ac11a1655db2f65fa1ab8d1fb7d5fd653"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the error on the livetime.  <a href="#ac11a1655db2f65fa1ab8d1fb7d5fd653">More...</a><br/></td></tr>
<tr class="separator:ac11a1655db2f65fa1ab8d1fb7d5fd653"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26e2c75333d838c6acf877d3c8f3ce83"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a26e2c75333d838c6acf877d3c8f3ce83"></a>
TFile *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#a26e2c75333d838c6acf877d3c8f3ce83">GetFile</a> () const </td></tr>
<tr class="memdesc:a26e2c75333d838c6acf877d3c8f3ce83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reuturn pointer to the currently set run file. <br/></td></tr>
<tr class="separator:a26e2c75333d838c6acf877d3c8f3ce83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cb1c1b1879a841ce683ecd2f0d6e69e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9cb1c1b1879a841ce683ecd2f0d6e69e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#a9cb1c1b1879a841ce683ecd2f0d6e69e">SetFile</a> (TFile *file)</td></tr>
<tr class="memdesc:a9cb1c1b1879a841ce683ecd2f0d6e69e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the run file  Does not clear previous calculations. <br/></td></tr>
<tr class="separator:a9cb1c1b1879a841ce683ecd2f0d6e69e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab39219ed683c7184c0c59c379951df3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aab39219ed683c7184c0c59c379951df3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#aab39219ed683c7184c0c59c379951df3">Reset</a> ()</td></tr>
<tr class="memdesc:aab39219ed683c7184c0c59c379951df3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset all stored data (livetimes, etc.) to zero. <br/></td></tr>
<tr class="separator:aab39219ed683c7184c0c59c379951df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aa78240b3be042fa9a2b00d669c3e5816"><td class="memItemLeft" align="right" valign="top">static Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#aa78240b3be042fa9a2b00d669c3e5816">CalculateRuntime</a> (<a class="el" href="classmidas_1_1_database.html">midas::Database</a> *db, const char *which, Double_t &amp;start, Double_t &amp;stop)</td></tr>
<tr class="memdesc:aa78240b3be042fa9a2b00d669c3e5816"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the run time from saved ODB file.  <a href="#aa78240b3be042fa9a2b00d669c3e5816">More...</a><br/></td></tr>
<tr class="separator:aa78240b3be042fa9a2b00d669c3e5816"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16db8915c5c59d484230020a431c21d4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16db8915c5c59d484230020a431c21d4"></a>
static Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#a16db8915c5c59d484230020a431c21d4">CalculateRuntime</a> (<a class="el" href="classmidas_1_1_database.html">midas::Database</a> *db, const char *which)</td></tr>
<tr class="memdesc:a16db8915c5c59d484230020a431c21d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the run time from saved ODB file. <br/></td></tr>
<tr class="separator:a16db8915c5c59d484230020a431c21d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a259255742e7de0a78d940195a5257658"><td class="memItemLeft" align="right" valign="top">Bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#a259255742e7de0a78d940195a5257658">CheckFile</a> (TTree *&amp;t1, TTree *&amp;t3, <a class="el" href="classmidas_1_1_database.html">midas::Database</a> *&amp;db)</td></tr>
<tr class="memdesc:a259255742e7de0a78d940195a5257658"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make sure fFile is valid.  <a href="#a259255742e7de0a78d940195a5257658">More...</a><br/></td></tr>
<tr class="separator:a259255742e7de0a78d940195a5257658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a845077ec3cb279a2cabcea1a3e10df73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#a845077ec3cb279a2cabcea1a3e10df73">DoCalculate</a> (Double_t tbegin, Double_t tend)</td></tr>
<tr class="memdesc:a845077ec3cb279a2cabcea1a3e10df73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the work of live time calculations.  <a href="#a845077ec3cb279a2cabcea1a3e10df73">More...</a><br/></td></tr>
<tr class="separator:a845077ec3cb279a2cabcea1a3e10df73"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ad89e75feb4267d5f523ef2effd61bc79"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad89e75feb4267d5f523ef2effd61bc79"></a>
TFile *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79">fFile</a></td></tr>
<tr class="memdesc:ad89e75feb4267d5f523ef2effd61bc79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run file (no ownership) <br/></td></tr>
<tr class="separator:ad89e75feb4267d5f523ef2effd61bc79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc9d0d0aea6feae1c07c7342c3ec06f7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acc9d0d0aea6feae1c07c7342c3ec06f7"></a>
Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#acc9d0d0aea6feae1c07c7342c3ec06f7">fRuntime</a> [3]</td></tr>
<tr class="memdesc:acc9d0d0aea6feae1c07c7342c3ec06f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run times. <br/></td></tr>
<tr class="separator:acc9d0d0aea6feae1c07c7342c3ec06f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0796fb23c8fd8913dee931086e099412"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0796fb23c8fd8913dee931086e099412"></a>
Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#a0796fb23c8fd8913dee931086e099412">fBusytime</a> [3]</td></tr>
<tr class="memdesc:a0796fb23c8fd8913dee931086e099412"><td class="mdescLeft">&#160;</td><td class="mdescRight">Busy times. <br/></td></tr>
<tr class="separator:a0796fb23c8fd8913dee931086e099412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad518f3da6b6dede608ade596ee7ee989"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad518f3da6b6dede608ade596ee7ee989"></a>
Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdragon_1_1_live_time_calculator.html#ad518f3da6b6dede608ade596ee7ee989">fLivetime</a> [3]</td></tr>
<tr class="memdesc:ad518f3da6b6dede608ade596ee7ee989"><td class="mdescLeft">&#160;</td><td class="mdescRight">Live times. <br/></td></tr>
<tr class="separator:ad518f3da6b6dede608ade596ee7ee989"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Live time calculator. </p>
<p>Calculates the live time by looking at the measured run time (with the IO32 clock, so 50 ns precision) and sum of measured busy times for each event. The live time is defined as: (&lt;run time&gt;=""&gt; - &lt;busy time&gt;=""&gt;) / &lt;run time&gt;=""&gt;</p>
<p>Calculations can be performed for a complete run, subset of a run or a chain of runs. This class also calculates the live time for coincidences. For more information about how this is done, see the <a class="el" href="classdragon_1_1_coinc_busytime.html" title="Class to calculate total busy time for coincidence events.">dragon::CoincBusytime</a> class documentation </p>

<p>Definition at line <a class="el" href="_root_analysis_8hxx_source.html#l00522">522</a> of file <a class="el" href="_root_analysis_8hxx_source.html">RootAnalysis.hxx</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a1750d3e82c9a173d666046173c6bd026"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dragon::LiveTimeCalculator::LiveTimeCalculator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Empty. </p>
<p>Default Ctor </p>

<p>Definition at line <a class="el" href="_root_analysis_8cxx_source.html#l01485">1485</a> of file <a class="el" href="_root_analysis_8cxx_source.html">RootAnalysis.cxx</a>.</p>

<p>References <a class="el" href="_root_analysis_8cxx_source.html#l01503">Reset()</a>.</p>
<div class="fragment"><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                                            :</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a>(0)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;{</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#aab39219ed683c7184c0c59c379951df3" title="Reset all stored data (livetimes, etc.) to zero.">Reset</a>();</div>
}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a74b9d680bccece2ba6b6bb48f01a4a0f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dragon::LiveTimeCalculator::LiveTimeCalculator </td>
          <td>(</td>
          <td class="paramtype">TFile *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bool_t&#160;</td>
          <td class="paramname"><em>calculate</em> = <code>kTRUE</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize with a run file and perform optional calculation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>Pointer to TFile containing run data. Takes no ownership. </td></tr>
    <tr><td class="paramname">calculate</td><td>If set to true, performs a full-run live time calculation on initialization </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_root_analysis_8cxx_source.html#l01495">1495</a> of file <a class="el" href="_root_analysis_8cxx_source.html">RootAnalysis.cxx</a>.</p>

<p>References <a class="el" href="_root_analysis_8cxx_source.html#l01771">Calculate()</a>, and <a class="el" href="_root_analysis_8cxx_source.html#l01503">Reset()</a>.</p>
<div class="fragment"><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                                                                         :</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a>(file)</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;{</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#aab39219ed683c7184c0c59c379951df3" title="Reset all stored data (livetimes, etc.) to zero.">Reset</a>();</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="keywordflow">if</span>(calculate) <a class="code" href="classdragon_1_1_live_time_calculator.html#a2384a2e2f07879c87512f5a87c22de3f" title="Perform live time calculation across an entire run.">Calculate</a>();</div>
}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a2384a2e2f07879c87512f5a87c22de3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dragon::LiveTimeCalculator::Calculate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform live time calculation across an entire run. </p>
<p>Results can be viewed with <a class="el" href="classdragon_1_1_live_time_calculator.html#aad062068040d9581c206d36f88464346" title="Returns the live time fraction.">GetLivetime()</a>, <a class="el" href="classdragon_1_1_live_time_calculator.html#ac987f3280ec8f1856fe7dd576739bfd4" title="Returns the sum of busy times during the run (or subrun) in seconds.">GetBusytime()</a>, etc. </p>

<p>Definition at line <a class="el" href="_root_analysis_8cxx_source.html#l01771">1771</a> of file <a class="el" href="_root_analysis_8cxx_source.html">RootAnalysis.cxx</a>.</p>

<p>Referenced by <a class="el" href="_root_analysis_8cxx_source.html#l01495">LiveTimeCalculator()</a>, and <a class="el" href="_root_analysis_8cxx_source.html#l00859">dragon::BeamNorm::ReadSbCounts()</a>.</p>
<div class="fragment"><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;{</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#a845077ec3cb279a2cabcea1a3e10df73" title="Does the work of live time calculations.">DoCalculate</a>(-1, -1);</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7830d41ef712838917a5285e22623126"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dragon::LiveTimeCalculator::CalculateChain </td>
          <td>(</td>
          <td class="paramtype">TChain *&#160;</td>
          <td class="paramname"><em>chain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform live time calculation across a chain of runs. </p>
<p>Calculate overall times across a chain of runs. For this, the sum of running time and busy time across the chain are calculated and then used to figure out the live time fraction. </p>

<p>Definition at line <a class="el" href="_root_analysis_8cxx_source.html#l01799">1799</a> of file <a class="el" href="_root_analysis_8cxx_source.html">RootAnalysis.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;{</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  TFile* file0 = <a class="code" href="classdragon_1_1_live_time_calculator.html#a26e2c75333d838c6acf877d3c8f3ce83" title="Reuturn pointer to the currently set run file.">GetFile</a>(); <span class="keywordflow">if</span>(file0) { }</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  Double_t sumbusy[3] = {0,0,0}, sumrun[3] = {0,0,0};</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="keywordflow">for</span> (Int_t i=0; i&lt; chain-&gt;GetListOfFiles()-&gt;GetEntries(); ++i) {</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    TFile* f = TFile::Open ( chain-&gt;GetListOfFiles()-&gt;At(i)-&gt;GetTitle() );</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <span class="keywordflow">if</span>(f-&gt;IsZombie()) { f-&gt;Close(); <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <a class="code" href="classdragon_1_1_live_time_calculator.html#a9cb1c1b1879a841ce683ecd2f0d6e69e" title="Change the run file  Does not clear previous calculations.">SetFile</a>(f);</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <a class="code" href="classdragon_1_1_live_time_calculator.html#a2384a2e2f07879c87512f5a87c22de3f" title="Perform live time calculation across an entire run.">Calculate</a>();</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    sumrun[0]  += <a class="code" href="classdragon_1_1_live_time_calculator.html#af047b208c8ea1a4633e2fc7fbe5c6409" title="Returns the run time in seconds.">GetRuntime</a>(<span class="stringliteral">&quot;head&quot;</span>);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    sumrun[1]  += <a class="code" href="classdragon_1_1_live_time_calculator.html#af047b208c8ea1a4633e2fc7fbe5c6409" title="Returns the run time in seconds.">GetRuntime</a>(<span class="stringliteral">&quot;tail&quot;</span>);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    sumrun[2]  += <a class="code" href="classdragon_1_1_live_time_calculator.html#af047b208c8ea1a4633e2fc7fbe5c6409" title="Returns the run time in seconds.">GetRuntime</a>(<span class="stringliteral">&quot;coinc&quot;</span>);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    sumbusy[0] += <a class="code" href="classdragon_1_1_live_time_calculator.html#ac987f3280ec8f1856fe7dd576739bfd4" title="Returns the sum of busy times during the run (or subrun) in seconds.">GetBusytime</a>(<span class="stringliteral">&quot;head&quot;</span>);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    sumbusy[1] += <a class="code" href="classdragon_1_1_live_time_calculator.html#ac987f3280ec8f1856fe7dd576739bfd4" title="Returns the sum of busy times during the run (or subrun) in seconds.">GetBusytime</a>(<span class="stringliteral">&quot;tail&quot;</span>);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    sumbusy[2] += <a class="code" href="classdragon_1_1_live_time_calculator.html#ac987f3280ec8f1856fe7dd576739bfd4" title="Returns the sum of busy times during the run (or subrun) in seconds.">GetBusytime</a>(<span class="stringliteral">&quot;coinc&quot;</span>);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    f-&gt;Close();</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  }</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt; 3; ++i) {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <a class="code" href="classdragon_1_1_live_time_calculator.html#a0796fb23c8fd8913dee931086e099412" title="Busy times.">fBusytime</a>[i] = sumbusy[i];</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <a class="code" href="classdragon_1_1_live_time_calculator.html#acc9d0d0aea6feae1c07c7342c3ec06f7" title="Run times.">fRuntime</a>[i]  = sumrun[i];</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <a class="code" href="classdragon_1_1_live_time_calculator.html#ad518f3da6b6dede608ade596ee7ee989" title="Live times.">fLivetime</a>[i] = (sumrun[i] - sumbusy[i]) / sumrun[i];</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  }</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa78240b3be042fa9a2b00d669c3e5816"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Double_t dragon::LiveTimeCalculator::CalculateRuntime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmidas_1_1_database.html">midas::Database</a> *&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>which</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t &amp;&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t &amp;&#160;</td>
          <td class="paramname"><em>stop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the run time from saved ODB file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">db</td><td>Pointer to the "odbstop" database for the current run </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">which</td><td>"head", "tail", or "coinc" </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">start</td><td>Run start time (relative to TSC reset) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stop</td><td>Run stop time (relative to TSC reset) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Total run time in seconds. Note that in the case of "coinc", the runtime is calculated as &lt; smallest stop time &gt; - &lt; largest start time &gt;, i.e. it is the total time during which <em>both</em> acquisitions are taking triggers.</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>In some cases this could fail to correctly calculate the rollover due to mismatches in the clocks... I think. This will be extremely rare but is something to keep in the back of your mind. </dd></dl>

<p>Definition at line <a class="el" href="_root_analysis_8cxx_source.html#l01615">1615</a> of file <a class="el" href="_root_analysis_8cxx_source.html">RootAnalysis.cxx</a>.</p>

<p>References <a class="el" href="_database_8hxx_source.html#l00164">midas::Database::ReadArray()</a>, and <a class="el" href="_database_8hxx_source.html#l00132">midas::Database::ReadValue()</a>.</p>
<div class="fragment"><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;{</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  Int_t time0, time1, tclock;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  db-&gt;<a class="code" href="classmidas_1_1_database.html#abdb5200de846e62960465479eddb0ac3" title="Read a single value.">ReadValue</a>(<span class="stringliteral">&quot;/Runinfo/Start time binary&quot;</span>, time0); <span class="comment">// computer clock start</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  db-&gt;<a class="code" href="classmidas_1_1_database.html#abdb5200de846e62960465479eddb0ac3" title="Read a single value.">ReadValue</a>(<span class="stringliteral">&quot;/Runinfo/Stop time binary&quot;</span>,  time1); <span class="comment">// computer clock stop</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  tclock = time1 - time0;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <span class="comment">// Read TSC start, stop times from the ODB</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="keywordtype">double</span> trigStart[2], trigStop[2];</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  db-&gt;<a class="code" href="classmidas_1_1_database.html#a53e537956023cbf5056d91fd65c26590" title="Read an array.">ReadArray</a>(<span class="stringliteral">&quot;/Experiment/Run Parameters/TSC_TriggerStart&quot;</span>, trigStart, 2);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  db-&gt;<a class="code" href="classmidas_1_1_database.html#a53e537956023cbf5056d91fd65c26590" title="Read an array.">ReadArray</a>(<span class="stringliteral">&quot;/Experiment/Run Parameters/TSC_TriggerStop&quot;</span>,  trigStop,  2);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <span class="comment">// Append rollovers to stop time</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="keyword">const</span> Double_t rolltime = 0xffffffff / 20e6; <span class="comment">// 32-bit clock rollover in seconds</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="keywordtype">int</span> nroll = tclock / rolltime;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;2; ++i) trigStop[i] += nroll*rolltime;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  <span class="comment">// now calculte the appropriate run time</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="keywordflow">switch</span>(get_which_indx(which)) {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  <span class="keywordflow">case</span> 0: <span class="comment">// &quot;head&quot;</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    stop  = trigStop[0];</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    start = trigStart[0];</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  <span class="keywordflow">case</span> 1: <span class="comment">// &quot;tail&quot;</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    stop  = trigStop[1];</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    start = trigStart[1];</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="keywordflow">case</span> 2: <span class="comment">// &quot;coinc&quot;</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    stop  = *std::min_element(trigStop, trigStop + 2);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    start = *std::max_element(trigStart, trigStart + 2);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    utils::Error(<span class="stringliteral">&quot;CalculateRuntime&quot;</span>, __FILE__, __LINE__)</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Invalid \&quot;which\&quot; specification: \&quot;&quot;</span> &lt;&lt; which &lt;&lt; <span class="stringliteral">&quot;\&quot;, valid options &quot;</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;are \&quot;head\&quot;, \&quot;tail\&quot;, or \&quot;coinc\&quot;&quot;</span>;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    stop = 0;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    start = 0;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="keywordflow">return</span> stop - start;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa06012632835e5148ef3a6a0d4d4e585"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dragon::LiveTimeCalculator::CalculateSub </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>tbegin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>tend</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform live time calculation across a subset of the run. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tbegin</td><td>Beginning of the run sub section (in seconds) </td></tr>
    <tr><td class="paramname">tend</td><td>End of the run sub section (seconds). If specified greater than the end of the run, this will just calculate up to the end of the run.</td></tr>
  </table>
  </dd>
</dl>
<p>The parameters <em>tbegin</em> and <em>tend</em> are both relative to the "trigger
start", which is the time at which the frontend begins to accept triggers (this is ~2 seconds later than the "run start" time, which would be when the user pushed start on the MIDAS page. The difference is due to the time it takes for the frontend programs to complete their startup routines.</p>
<p>Results can be viewed with <a class="el" href="classdragon_1_1_live_time_calculator.html#aad062068040d9581c206d36f88464346" title="Returns the live time fraction.">GetLivetime()</a>, <a class="el" href="classdragon_1_1_live_time_calculator.html#ac987f3280ec8f1856fe7dd576739bfd4" title="Returns the sum of busy times during the run (or subrun) in seconds.">GetBusytime()</a>, etc. </p>

<p>Definition at line <a class="el" href="_root_analysis_8cxx_source.html#l01789">1789</a> of file <a class="el" href="_root_analysis_8cxx_source.html">RootAnalysis.cxx</a>.</p>

<p>Referenced by <a class="el" href="_root_analysis_8cxx_source.html#l00859">dragon::BeamNorm::ReadSbCounts()</a>.</p>
<div class="fragment"><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;{</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#a845077ec3cb279a2cabcea1a3e10df73" title="Does the work of live time calculations.">DoCalculate</a>(tbegin, tend);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a259255742e7de0a78d940195a5257658"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Bool_t dragon::LiveTimeCalculator::CheckFile </td>
          <td>(</td>
          <td class="paramtype">TTree *&amp;&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TTree *&amp;&#160;</td>
          <td class="paramname"><em>t3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmidas_1_1_database.html">midas::Database</a> *&amp;&#160;</td>
          <td class="paramname"><em>db</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make sure fFile is valid. </p>
<p>Also sets tree and DB pointers </p>

<p>Definition at line <a class="el" href="_root_analysis_8cxx_source.html#l01554">1554</a> of file <a class="el" href="_root_analysis_8cxx_source.html">RootAnalysis.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;{</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a> || <a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a>-&gt;IsZombie()) {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <a class="code" href="classdragon_1_1utils_1_1_error.html" title="Specialized Strm class to print error messages.">dutils::Error</a>(<span class="stringliteral">&quot;LiveTimeCalculator::CheckFile&quot;</span>, __FILE__, __LINE__)</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Invalid or no file loaded.&quot;</span>;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="keywordflow">return</span> kFALSE;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  Bool_t okay = kTRUE;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="keywordflow">if</span>(okay) okay = <a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a>-&gt;Get(<span class="stringliteral">&quot;t1&quot;</span>) &amp;&amp; <a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a>-&gt;Get(<span class="stringliteral">&quot;t1&quot;</span>)-&gt;IsA() == TTree::Class();</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="keywordflow">if</span>(okay) okay = <a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a>-&gt;Get(<span class="stringliteral">&quot;t3&quot;</span>) &amp;&amp; <a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a>-&gt;Get(<span class="stringliteral">&quot;t3&quot;</span>)-&gt;IsA() == TTree::Class();</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="keywordflow">if</span>(!okay) {</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <a class="code" href="classdragon_1_1utils_1_1_error.html" title="Specialized Strm class to print error messages.">dutils::Error</a>(<span class="stringliteral">&quot;LiveTimeCalculator::CheckFile&quot;</span>, __FILE__, __LINE__)</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;missing necessary trees in loaded file&quot;</span>;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordflow">return</span> kFALSE;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    t1 = <span class="keyword">static_cast&lt;</span>TTree*<span class="keyword">&gt;</span>(<a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a>-&gt;Get(<span class="stringliteral">&quot;t1&quot;</span>));</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    t3 = <span class="keyword">static_cast&lt;</span>TTree*<span class="keyword">&gt;</span>(<a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a>-&gt;Get(<span class="stringliteral">&quot;t3&quot;</span>));</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  }</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="keywordflow">if</span>(okay) okay = t1-&gt;GetLeaf(<span class="stringliteral">&quot;io32.busy_time&quot;</span>);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="keywordflow">if</span>(okay) okay = t3-&gt;GetLeaf(<span class="stringliteral">&quot;io32.busy_time&quot;</span>);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="keywordflow">if</span>(!okay) {</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <a class="code" href="classdragon_1_1utils_1_1_error.html" title="Specialized Strm class to print error messages.">dutils::Error</a>(<span class="stringliteral">&quot;LiveTimeCalculator::CheckFile&quot;</span>, __FILE__, __LINE__)</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;missing leaf \&quot;io32.busy_time\&quot; in either \&quot;t1\&quot; or \&quot;t3\&quot;&quot;</span>;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="keywordflow">return</span> kFALSE;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  }</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <span class="keywordflow">if</span>(okay) okay = t1-&gt;GetLeaf(<span class="stringliteral">&quot;io32.tsc4.trig_time&quot;</span>);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <span class="keywordflow">if</span>(okay) okay = t3-&gt;GetLeaf(<span class="stringliteral">&quot;io32.tsc4.trig_time&quot;</span>);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <span class="keywordflow">if</span>(!okay) {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <a class="code" href="classdragon_1_1utils_1_1_error.html" title="Specialized Strm class to print error messages.">dutils::Error</a>(<span class="stringliteral">&quot;LiveTimeCalculator::CheckFile&quot;</span>, __FILE__, __LINE__)</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;missing leaf \&quot;io32.tsc4.trig_time\&quot; in either \&quot;t1\&quot; or \&quot;t3\&quot;&quot;</span>;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="keywordflow">return</span> kFALSE;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  }</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  okay = <a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a>-&gt;Get(<span class="stringliteral">&quot;odbstop&quot;</span>) &amp;&amp; <a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a>-&gt;Get(<span class="stringliteral">&quot;odbstop&quot;</span>)-&gt;InheritsFrom(midas::Database::Class());</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <span class="keywordflow">if</span>(!okay) {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <a class="code" href="classdragon_1_1utils_1_1_error.html" title="Specialized Strm class to print error messages.">dutils::Error</a>(<span class="stringliteral">&quot;LiveTimeCalculator::CheckFile&quot;</span>, __FILE__, __LINE__)</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Loaded file is missing database \&quot;odbstop\&quot;&quot;</span>;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keywordflow">return</span> kFALSE;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  }</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  db = <span class="keyword">static_cast&lt;</span><a class="code" href="classmidas_1_1_database.html" title="Generic database reading class.">midas::Database</a>*<span class="keyword">&gt;</span>(<a class="code" href="classdragon_1_1_live_time_calculator.html#ad89e75feb4267d5f523ef2effd61bc79" title="Run file (no ownership)">fFile</a>-&gt;Get(<span class="stringliteral">&quot;odbstop&quot;</span>));</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <span class="keywordflow">return</span> kTRUE;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a845077ec3cb279a2cabcea1a3e10df73"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dragon::LiveTimeCalculator::DoCalculate </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>tbegin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>tend</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Does the work of live time calculations. </p>
<p>Generic function called by public functions <a class="el" href="classdragon_1_1_live_time_calculator.html#a2384a2e2f07879c87512f5a87c22de3f" title="Perform live time calculation across an entire run.">Calculate()</a> and <a class="el" href="classdragon_1_1_live_time_calculator.html#aa06012632835e5148ef3a6a0d4d4e585" title="Perform live time calculation across a subset of the run.">CalculateSub()</a> </p>

<p>Definition at line <a class="el" href="_root_analysis_8cxx_source.html#l01689">1689</a> of file <a class="el" href="_root_analysis_8cxx_source.html">RootAnalysis.cxx</a>.</p>

<p>References <a class="el" href="_root_analysis_8cxx_source.html#l01869">dragon::CoincBusytime::AddEvent()</a>, and <a class="el" href="_root_analysis_8cxx_source.html#l01938">dragon::CoincBusytime::Calculate()</a>.</p>
<div class="fragment"><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;{</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="comment">// reset to default values</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#aab39219ed683c7184c0c59c379951df3" title="Reset all stored data (livetimes, etc.) to zero.">Reset</a>();</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="comment">// make sure arguments are workable, checkif full calculation or not</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  Bool_t isFull = (tbegin &lt; 0 || tend &lt; 0);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keywordflow">if</span> (isFull) {</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">if</span>(tbegin &gt; 0 || tend &gt; 0) {</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      utils::Error(<span class="stringliteral">&quot;LiveTimeCalculator::DoCalculate&quot;</span>, __FILE__, __LINE__)</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Invalid parameters to LiveTimeCalculator::DoCalculate(): &quot;</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;tbegin = &quot;</span> &lt;&lt; tbegin &lt;&lt;  <span class="stringliteral">&quot;, tend = &quot;</span> &lt;&lt; tend;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    }</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  }</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="keywordflow">if</span> (!isFull &amp;&amp; tend &lt;= tbegin) {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    utils::Error(<span class="stringliteral">&quot;LiveTimeCalculator::DoCalculate&quot;</span>, __FILE__, __LINE__)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Cannot have tend &lt;= tbegin: tend, tbegin = &quot;</span> &lt;&lt; tend &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; tbegin;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  }</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="comment">// Initialize midas database, TTrees, etc</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  <a class="code" href="classmidas_1_1_database.html" title="Generic database reading class.">midas::Database</a>* db = 0;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  TTree* trees[2] = { 0, 0 };</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <span class="keywordflow">if</span>(!<a class="code" href="classdragon_1_1_live_time_calculator.html#a259255742e7de0a78d940195a5257658" title="Make sure fFile is valid.">CheckFile</a>(trees[0], trees[1], db)) { <span class="comment">// CheckFile now sets trees[i], db if they&#39;re valid</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    utils::Error(<span class="stringliteral">&quot;LiveTimeCalculator::DoCalculate&quot;</span>, __FILE__, __LINE__)</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Invalid file or trees&quot;</span>;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  }</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keywordtype">size_t</span> nentries = trees[0]-&gt;GetEntries() + trees[1]-&gt;GetEntries();</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  CoincBusytime coincBusy(nentries);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  <span class="comment">// Ensure to reset branch addresses when done</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  AutoResetBranchAddresses Rst_(trees, 2);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <span class="comment">// Get run times</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <span class="keywordtype">double</span> trigStart[3], trigStop[3];</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#aa78240b3be042fa9a2b00d669c3e5816" title="Calculate the run time from saved ODB file.">CalculateRuntime</a>(db, <span class="stringliteral">&quot;head&quot;</span>,  trigStart[0], trigStop[0]);</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#aa78240b3be042fa9a2b00d669c3e5816" title="Calculate the run time from saved ODB file.">CalculateRuntime</a>(db, <span class="stringliteral">&quot;tail&quot;</span>,  trigStart[1], trigStop[1]);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#aa78240b3be042fa9a2b00d669c3e5816" title="Calculate the run time from saved ODB file.">CalculateRuntime</a>(db, <span class="stringliteral">&quot;coinc&quot;</span>, trigStart[2], trigStop[2]);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="comment">// Loop over trees</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt; 2; ++i) {</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="comment">// Set MakeClass to 1 (resets at end of loop or return)</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    SetMakeClass_t dummy(trees[i], 1);</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="comment">// Find branches</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    UInt_t busy_time;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    Double_t trig_time;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    TBranch* trigBranch = get_branch(trees[i], trig_time, <span class="stringliteral">&quot;io32.tsc4.trig_time&quot;</span>,</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                                     <span class="stringliteral">&quot;LiveTimeCalculator::DoCalculate&quot;</span>);</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    TBranch* busyBranch = get_branch(trees[i], busy_time, <span class="stringliteral">&quot;io32.busy_time&quot;</span>,</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                                     <span class="stringliteral">&quot;LiveTimeCalculator::DoCalculate&quot;</span>);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="keywordflow">if</span>(!trigBranch || !busyBranch) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="comment">// Correct TSC4 rollover for early runs taken with a frontend bug</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    Double_t rollCorrect = correct_rollover_fe_bug(trigBranch, trig_time);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    Long64_t busyTotal = 0;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    Long64_t nentries = trees[i]-&gt;GetEntries();</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="keywordflow">for</span>(Long64_t entry = 0; entry&lt; nentries; ++entry) {</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <span class="comment">// read entries</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      trigBranch-&gt;GetEntry(entry);</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      busyBranch-&gt;GetEntry(entry);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <span class="keyword">const</span> Double_t trigtime = trig_time - rollCorrect - trigStart[i];</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      <span class="comment">// check cut condition</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      <span class="keywordflow">if</span> (!isFull &amp;&amp; !(trigtime &gt; tbegin*1e6 &amp;&amp; trigtime &lt; tend*1e6))</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      <span class="comment">// accuulate busy time</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      busyTotal += busy_time;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      coincBusy.AddEvent(trigtime, busy_time/20.);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="comment">// calculate variables</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <a class="code" href="classdragon_1_1_live_time_calculator.html#a0796fb23c8fd8913dee931086e099412" title="Busy times.">fBusytime</a>[i] = busyTotal / 20e6;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <a class="code" href="classdragon_1_1_live_time_calculator.html#acc9d0d0aea6feae1c07c7342c3ec06f7" title="Run times.">fRuntime</a>[i]  = isFull ? trigStop[i] - trigStart[i] : tend - tbegin;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <a class="code" href="classdragon_1_1_live_time_calculator.html#ad518f3da6b6dede608ade596ee7ee989" title="Live times.">fLivetime</a>[i] = (<a class="code" href="classdragon_1_1_live_time_calculator.html#acc9d0d0aea6feae1c07c7342c3ec06f7" title="Run times.">fRuntime</a>[i] - <a class="code" href="classdragon_1_1_live_time_calculator.html#a0796fb23c8fd8913dee931086e099412" title="Busy times.">fBusytime</a>[i]) / <a class="code" href="classdragon_1_1_live_time_calculator.html#acc9d0d0aea6feae1c07c7342c3ec06f7" title="Run times.">fRuntime</a>[i];</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#acc9d0d0aea6feae1c07c7342c3ec06f7" title="Run times.">fRuntime</a>[2]  = isFull ? trigStop[2] - trigStart[2] : tend - tbegin;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#a0796fb23c8fd8913dee931086e099412" title="Busy times.">fBusytime</a>[2] = coincBusy.Calculate();</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  <a class="code" href="classdragon_1_1_live_time_calculator.html#ad518f3da6b6dede608ade596ee7ee989" title="Live times.">fLivetime</a>[2] = (<a class="code" href="classdragon_1_1_live_time_calculator.html#acc9d0d0aea6feae1c07c7342c3ec06f7" title="Run times.">fRuntime</a>[2] - <a class="code" href="classdragon_1_1_live_time_calculator.html#a0796fb23c8fd8913dee931086e099412" title="Busy times.">fBusytime</a>[2]) / <a class="code" href="classdragon_1_1_live_time_calculator.html#acc9d0d0aea6feae1c07c7342c3ec06f7" title="Run times.">fRuntime</a>[2];</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac11a1655db2f65fa1ab8d1fb7d5fd653"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Double_t dragon::LiveTimeCalculator::GetLivetimeError </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>which</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the error on the livetime. </p>
<p>The relative error should </p>

<p>Definition at line <a class="el" href="_root_analysis_8hxx_source.html#l00545">545</a> of file <a class="el" href="_root_analysis_8hxx_source.html">RootAnalysis.hxx</a>.</p>

<p>References <a class="el" href="_root_analysis_8cxx_source.html#l01547">GetLivetime()</a>.</p>
<div class="fragment"><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    { <span class="keywordflow">return</span> <a class="code" href="classdragon_1_1_live_time_calculator.html#aad062068040d9581c206d36f88464346" title="Returns the live time fraction.">GetLivetime</a>(which) * 50/1e6; } <span class="comment">// seconds</span></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/dragon/packages/dragon/analyzer/src/utils/<a class="el" href="_root_analysis_8hxx_source.html">RootAnalysis.hxx</a></li>
<li>/Users/dragon/packages/dragon/analyzer/src/utils/<a class="el" href="_root_analysis_8cxx_source.html">RootAnalysis.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 24 2018 14:08:53 for DRAGON Analyzer by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
