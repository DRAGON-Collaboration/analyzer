<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DRAGON Analyzer: tstamp::Queue Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DRAGON Analyzer
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacetstamp.html">tstamp</a></li><li class="navelem"><a class="el" href="clasststamp_1_1_queue.html">Queue</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="clasststamp_1_1_queue-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">tstamp::Queue Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class to manage coincidence/singles ID.  
 <a href="clasststamp_1_1_queue.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_t_stamp_8hxx_source.html">TStamp.hxx</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for tstamp::Queue:</div>
<div class="dyncontent">
<div class="center"><img src="clasststamp_1_1_queue__inherit__graph.png" border="0" usemap="#tstamp_1_1_queue_inherit__map" alt="Inheritance graph"/></div>
<map name="tstamp_1_1_queue_inherit__map" id="tstamp_1_1_queue_inherit__map">
<area shape="rect" id="node2" href="clasststamp_1_1_owned_queue.html" title="Queue that is a member of another class which handles popped events. " alt="" coords="5,79,187,104"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for tstamp::Queue:</div>
<div class="dyncontent">
<div class="center"><img src="clasststamp_1_1_queue__coll__graph.png" border="0" usemap="#tstamp_1_1_queue_coll__map" alt="Collaboration graph"/></div>
<map name="tstamp_1_1_queue_coll__map" id="tstamp_1_1_queue_coll__map">
<area shape="rect" id="node3" href="classmidas_1_1_event.html" title="Derived class of TMidasEvent for timestamped dragon events. " alt="" coords="80,92,179,117"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:af0de8edc893fa05e3766220d8940e614"><td class="memItemLeft" align="right" valign="top">typedef std::multiset&lt; <a class="el" href="classmidas_1_1_event.html">midas::Event</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#af0de8edc893fa05e3766220d8940e614">MultiSet_t</a></td></tr>
<tr class="memdesc:af0de8edc893fa05e3766220d8940e614"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal container type used to store events.  <a href="#af0de8edc893fa05e3766220d8940e614">More...</a><br /></td></tr>
<tr class="separator:af0de8edc893fa05e3766220d8940e614"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acafa71d2f1230b246a9b21e00576786d"><td class="memItemLeft" align="right" valign="top"><a id="acafa71d2f1230b246a9b21e00576786d"></a>
typedef std::pair&lt; MultiSet_t::iterator, MultiSet_t::iterator &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#acafa71d2f1230b246a9b21e00576786d">EqualRange_t</a></td></tr>
<tr class="memdesc:acafa71d2f1230b246a9b21e00576786d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pair of MultiSet_t iterators, returned from std::multiset::equal_range() <br /></td></tr>
<tr class="separator:acafa71d2f1230b246a9b21e00576786d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a32d4e2649accbbbc8c2cca95a28afeae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a32d4e2649accbbbc8c2cca95a28afeae">Queue</a> (double deltaMax)</td></tr>
<tr class="memdesc:a32d4e2649accbbbc8c2cca95a28afeae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the maximum container size (fMaxDelta)  <a href="#a32d4e2649accbbbc8c2cca95a28afeae">More...</a><br /></td></tr>
<tr class="separator:a32d4e2649accbbbc8c2cca95a28afeae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a585f0a4a4173b0edf2637ea3099e7128"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a585f0a4a4173b0edf2637ea3099e7128">~Queue</a> ()</td></tr>
<tr class="memdesc:a585f0a4a4173b0edf2637ea3099e7128"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor, empty.  <a href="#a585f0a4a4173b0edf2637ea3099e7128">More...</a><br /></td></tr>
<tr class="separator:a585f0a4a4173b0edf2637ea3099e7128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec131fb4adef03e358ac57e7bb39118b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#aec131fb4adef03e358ac57e7bb39118b">Push</a> (const <a class="el" href="classmidas_1_1_event.html">midas::Event</a> &amp;, <a class="el" href="clasststamp_1_1_diagnostics.html">tstamp::Diagnostics</a> *diagnostics=0)</td></tr>
<tr class="memdesc:aec131fb4adef03e358ac57e7bb39118b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert an element into the queue.  <a href="#aec131fb4adef03e358ac57e7bb39118b">More...</a><br /></td></tr>
<tr class="separator:aec131fb4adef03e358ac57e7bb39118b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afba5a1454d0e23085b6dc21b3a8af394"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#afba5a1454d0e23085b6dc21b3a8af394">Pop</a> (int32_t &amp;singles_id, bool &amp;found_coinc)</td></tr>
<tr class="memdesc:afba5a1454d0e23085b6dc21b3a8af394"><td class="mdescLeft">&#160;</td><td class="mdescRight">Erase the earliest event in the queue, first searching for coincidences.  <a href="#afba5a1454d0e23085b6dc21b3a8af394">More...</a><br /></td></tr>
<tr class="separator:afba5a1454d0e23085b6dc21b3a8af394"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11624971fcc3d9670cf485c9a0be51a3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a11624971fcc3d9670cf485c9a0be51a3">Flush</a> (int max_time=-1, <a class="el" href="clasststamp_1_1_diagnostics.html">tstamp::Diagnostics</a> *diagnostics=0)</td></tr>
<tr class="memdesc:a11624971fcc3d9670cf485c9a0be51a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush all events from the queue.  <a href="#a11624971fcc3d9670cf485c9a0be51a3">More...</a><br /></td></tr>
<tr class="separator:a11624971fcc3d9670cf485c9a0be51a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab85c4725ac0a13ae9dfcabb7f3cfeef4"><td class="memItemLeft" align="right" valign="top">virtual size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#ab85c4725ac0a13ae9dfcabb7f3cfeef4">FlushIterative</a> (<a class="el" href="clasststamp_1_1_diagnostics.html">tstamp::Diagnostics</a> *diagnostics=0)</td></tr>
<tr class="memdesc:ab85c4725ac0a13ae9dfcabb7f3cfeef4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flush a single event from the queue.  <a href="#ab85c4725ac0a13ae9dfcabb7f3cfeef4">More...</a><br /></td></tr>
<tr class="separator:ab85c4725ac0a13ae9dfcabb7f3cfeef4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dd183e4250893a7525f0e81089cb640"><td class="memItemLeft" align="right" valign="top"><a id="a8dd183e4250893a7525f0e81089cb640"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a8dd183e4250893a7525f0e81089cb640">Size</a> () const</td></tr>
<tr class="memdesc:a8dd183e4250893a7525f0e81089cb640"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns total number of entries in the queue. <br /></td></tr>
<tr class="separator:a8dd183e4250893a7525f0e81089cb640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d2e31f334b786b100eb27fbefb67d35"><td class="memItemLeft" align="right" valign="top"><a id="a0d2e31f334b786b100eb27fbefb67d35"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a0d2e31f334b786b100eb27fbefb67d35">SetMaxDelta</a> (double delta)</td></tr>
<tr class="memdesc:a0d2e31f334b786b100eb27fbefb67d35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the maximum queue time to a new value. <br /></td></tr>
<tr class="separator:a0d2e31f334b786b100eb27fbefb67d35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f6faa8b24d2dd01a2eaf17438f585e6"><td class="memItemLeft" align="right" valign="top"><a id="a9f6faa8b24d2dd01a2eaf17438f585e6"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a9f6faa8b24d2dd01a2eaf17438f585e6">GetMaxDelta</a> () const</td></tr>
<tr class="memdesc:a9f6faa8b24d2dd01a2eaf17438f585e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the maximum queue time. <br /></td></tr>
<tr class="separator:a9f6faa8b24d2dd01a2eaf17438f585e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc3b5b6a85fab7ed0cf69a5ed328c98"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a6cc3b5b6a85fab7ed0cf69a5ed328c98">FlushTimeoutMessage</a> (int max_time) const</td></tr>
<tr class="memdesc:a6cc3b5b6a85fab7ed0cf69a5ed328c98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints a message telling that <a class="el" href="clasststamp_1_1_queue.html#a11624971fcc3d9670cf485c9a0be51a3" title="Flush all events from the queue. ">Flush()</a> timeout has been reached.  <a href="#a6cc3b5b6a85fab7ed0cf69a5ed328c98">More...</a><br /></td></tr>
<tr class="separator:a6cc3b5b6a85fab7ed0cf69a5ed328c98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d1e9f409d7ff1c677e4143ab98fb57b"><td class="memItemLeft" align="right" valign="top"><a id="a3d1e9f409d7ff1c677e4143ab98fb57b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a3d1e9f409d7ff1c677e4143ab98fb57b">Clear</a> ()</td></tr>
<tr class="memdesc:a3d1e9f409d7ff1c677e4143ab98fb57b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manually clear the event buffer. <br /></td></tr>
<tr class="separator:a3d1e9f409d7ff1c677e4143ab98fb57b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a227aaad40d758d1838ebea52389f715e"><td class="memItemLeft" align="right" valign="top"><a id="a227aaad40d758d1838ebea52389f715e"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a227aaad40d758d1838ebea52389f715e">IsFull</a> () const</td></tr>
<tr class="memdesc:a227aaad40d758d1838ebea52389f715e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether the maximum size has been reached. <br /></td></tr>
<tr class="separator:a227aaad40d758d1838ebea52389f715e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6be20fb57ec3a1bd5f6618290797888c"><td class="memItemLeft" align="right" valign="top"><a id="a6be20fb57ec3a1bd5f6618290797888c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a6be20fb57ec3a1bd5f6618290797888c">MaxTimeDiff</a> () const</td></tr>
<tr class="memdesc:a6be20fb57ec3a1bd5f6618290797888c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get trigger time difference between earliest and latest event. <br /></td></tr>
<tr class="separator:a6be20fb57ec3a1bd5f6618290797888c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6ed4bc00093c9f4a76ca3370fdd140d"><td class="memItemLeft" align="right" valign="top"><a id="ac6ed4bc00093c9f4a76ca3370fdd140d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#ac6ed4bc00093c9f4a76ca3370fdd140d">FillDiagnostics</a> (<a class="el" href="clasststamp_1_1_diagnostics.html">tstamp::Diagnostics</a> *d, double tdiff, bool have_coinc, int32_t singles_id, uint32_t evt_time)</td></tr>
<tr class="memdesc:ac6ed4bc00093c9f4a76ca3370fdd140d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill diagnostic information after a push. <br /></td></tr>
<tr class="separator:ac6ed4bc00093c9f4a76ca3370fdd140d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a7ed9b6d449f71b176b2e2e4048f41829"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a7ed9b6d449f71b176b2e2e4048f41829">HandleCoinc</a> (const <a class="el" href="classmidas_1_1_event.html">midas::Event</a> &amp;e1, const <a class="el" href="classmidas_1_1_event.html">midas::Event</a> &amp;e2) const</td></tr>
<tr class="memdesc:a7ed9b6d449f71b176b2e2e4048f41829"><td class="mdescLeft">&#160;</td><td class="mdescRight">What to do in case of a coincidence event.  <a href="#a7ed9b6d449f71b176b2e2e4048f41829">More...</a><br /></td></tr>
<tr class="separator:a7ed9b6d449f71b176b2e2e4048f41829"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5391a0145cdd9899bebe790e8abecf9f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a5391a0145cdd9899bebe790e8abecf9f">HandleSingle</a> (const <a class="el" href="classmidas_1_1_event.html">midas::Event</a> &amp;event) const</td></tr>
<tr class="memdesc:a5391a0145cdd9899bebe790e8abecf9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">What to do in case of a singles event.  <a href="#a5391a0145cdd9899bebe790e8abecf9f">More...</a><br /></td></tr>
<tr class="separator:a5391a0145cdd9899bebe790e8abecf9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36d9414fe16b9c6ad4ff6e2338fe9e4b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a36d9414fe16b9c6ad4ff6e2338fe9e4b">HandleDiagnostics</a> (<a class="el" href="clasststamp_1_1_diagnostics.html">tstamp::Diagnostics</a> *diagnostics) const</td></tr>
<tr class="memdesc:a36d9414fe16b9c6ad4ff6e2338fe9e4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">What to do with a diagnostics event.  <a href="#a36d9414fe16b9c6ad4ff6e2338fe9e4b">More...</a><br /></td></tr>
<tr class="separator:a36d9414fe16b9c6ad4ff6e2338fe9e4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6df95dcf3177a513205eaa8695c21be4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a6df95dcf3177a513205eaa8695c21be4">DoFlushEvent</a> (<a class="el" href="clasststamp_1_1_diagnostics.html">tstamp::Diagnostics</a> *)</td></tr>
<tr class="memdesc:a6df95dcf3177a513205eaa8695c21be4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal helper function for flushing routines.  <a href="#a6df95dcf3177a513205eaa8695c21be4">More...</a><br /></td></tr>
<tr class="separator:a6df95dcf3177a513205eaa8695c21be4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aec2d9b881be532dcae89a468382b98c5"><td class="memItemLeft" align="right" valign="top"><a id="aec2d9b881be532dcae89a468382b98c5"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#aec2d9b881be532dcae89a468382b98c5">fMaxDelta</a></td></tr>
<tr class="memdesc:aec2d9b881be532dcae89a468382b98c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum allowable time interval between the first and last event stored in the queue. <br /></td></tr>
<tr class="separator:aec2d9b881be532dcae89a468382b98c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a356a54b6e6714830e4e124da0c6c2d6b"><td class="memItemLeft" align="right" valign="top"><a id="a356a54b6e6714830e4e124da0c6c2d6b"></a>
<a class="el" href="clasststamp_1_1_queue.html#af0de8edc893fa05e3766220d8940e614">MultiSet_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a></td></tr>
<tr class="memdesc:a356a54b6e6714830e4e124da0c6c2d6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal container of events waiting to be matched. <br /></td></tr>
<tr class="separator:a356a54b6e6714830e4e124da0c6c2d6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class to manage coincidence/singles ID. </p>
<p>The basic idea is to buffer events in a queue for long enough to ensure that any possible coincidence events have been received from the data source. Then, check if the early event has any coincidence matches, and, if so, to process the events together. Then the earliest event is processed as a singles event and removed from the queue.</p>
<p>The interface consists of <a class="el" href="clasststamp_1_1_queue.html#aec131fb4adef03e358ac57e7bb39118b" title="Insert an element into the queue. ">Push()</a> and <a class="el" href="clasststamp_1_1_queue.html#afba5a1454d0e23085b6dc21b3a8af394" title="Erase the earliest event in the queue, first searching for coincidences. ">Pop()</a> functions to insert and remove events from the queue, <a class="el" href="clasststamp_1_1_queue.html#a8dd183e4250893a7525f0e81089cb640" title="Returns total number of entries in the queue. ">Size()</a> to get the queue length, and <a class="el" href="clasststamp_1_1_queue.html#a11624971fcc3d9670cf485c9a0be51a3" title="Flush all events from the queue. ">Flush()</a> to explicitly empty the queue. To set how coincidence and singles events should be handled, the class provides the private virtual functions <a class="el" href="clasststamp_1_1_queue.html#a7ed9b6d449f71b176b2e2e4048f41829" title="What to do in case of a coincidence event. ">HandleCoinc()</a> and <a class="el" href="clasststamp_1_1_queue.html#a5391a0145cdd9899bebe790e8abecf9f" title="What to do in case of a singles event. ">HandleSingle()</a>. In the base class, these simply print some information about the arguments to stdout. </p>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8hxx_source.html#l00031">31</a> of file <a class="el" href="_t_stamp_8hxx_source.html">TStamp.hxx</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="af0de8edc893fa05e3766220d8940e614"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0de8edc893fa05e3766220d8940e614">&#9670;&nbsp;</a></span>MultiSet_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::multiset&lt;<a class="el" href="classmidas_1_1_event.html">midas::Event</a>&gt; <a class="el" href="clasststamp_1_1_queue.html#af0de8edc893fa05e3766220d8940e614">tstamp::Queue::MultiSet_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Internal container type used to store events. </p>
<p>Performance testing has indicated that a <code>std::multiset</code> is the optimal container for our needs:</p><ul>
<li>Frequent insertion into the container</li>
<li>Frequent removal of the oldest element in the container</li>
<li>Quick identification of (possible multiple) coincidences by searching on the trigger time</li>
</ul>
<p>Others containers tested included a sorted <code>std::deque</code> or <code>std::vector</code>; <code>boost::container::flat_multiset</code> (essentially a sorted <code>std::vector</code>); and <code>boost::unordered_multiset</code>. The sorted <code>std::deque</code> performed similarly to <code>std::multiset</code> for objects with cheap copy operations (e.g. a simple 'int' or 'double'), but for objects with non-trivial copy constructors the extra copy operations required to maintain sorting inhibit performance significantly (note that <code>std::vector</code> had bad performance in all cases due to the expense of removing items at the beginning of the vector).</p>
<p>The boost hash implementation (<code>boost::unordered_multiset</code>) showed slightly better performance for coincidence matching than the <code>std::multiset</code>; however, the the increase was not significant, and it is not likely that it's worth the extra code required to keep track of the earliest entry and the the reliance on "non-standard" third-party code for a hash implementation. </p>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8hxx_source.html#l00054">54</a> of file <a class="el" href="_t_stamp_8hxx_source.html">TStamp.hxx</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a32d4e2649accbbbc8c2cca95a28afeae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32d4e2649accbbbc8c2cca95a28afeae">&#9670;&nbsp;</a></span>Queue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tstamp::Queue::Queue </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaMax</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the maximum container size (fMaxDelta) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">deltaMax</td><td>Maximum difference between timestamps before emptying </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><em>deltaMax</em> should be set large enough to cover any potential timstamp overlaps, but without taking up too much memory </dd></dl>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8hxx_source.html#l00073">73</a> of file <a class="el" href="_t_stamp_8hxx_source.html">TStamp.hxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;: <a class="code" href="clasststamp_1_1_queue.html#aec2d9b881be532dcae89a468382b98c5">fMaxDelta</a> (deltaMax) { }</div><div class="ttc" id="clasststamp_1_1_queue_html_aec2d9b881be532dcae89a468382b98c5"><div class="ttname"><a href="clasststamp_1_1_queue.html#aec2d9b881be532dcae89a468382b98c5">tstamp::Queue::fMaxDelta</a></div><div class="ttdeci">double fMaxDelta</div><div class="ttdoc">Maximum allowable time interval between the first and last event stored in the queue. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8hxx_source.html#l00061">TStamp.hxx:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a585f0a4a4173b0edf2637ea3099e7128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a585f0a4a4173b0edf2637ea3099e7128">&#9670;&nbsp;</a></span>~Queue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual tstamp::Queue::~Queue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor, empty. </p>
<dl class="section warning"><dt>Warning</dt><dd>It may be tempting to put a call to <a class="el" href="clasststamp_1_1_queue.html#a11624971fcc3d9670cf485c9a0be51a3" title="Flush all events from the queue. ">Flush()</a> into the destructor; however, this is a bad idea since <a class="el" href="clasststamp_1_1_queue.html#a11624971fcc3d9670cf485c9a0be51a3" title="Flush all events from the queue. ">Flush()</a> will make calls to the virtual function <a class="el" href="clasststamp_1_1_queue.html#a5391a0145cdd9899bebe790e8abecf9f" title="What to do in case of a singles event. ">HandleSingle()</a> and maybe <a class="el" href="clasststamp_1_1_queue.html#a7ed9b6d449f71b176b2e2e4048f41829" title="What to do in case of a coincidence event. ">HandleCoinc()</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8hxx_source.html#l00081">81</a> of file <a class="el" href="_t_stamp_8hxx_source.html">TStamp.hxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;{ }</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6df95dcf3177a513205eaa8695c21be4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6df95dcf3177a513205eaa8695c21be4">&#9670;&nbsp;</a></span>DoFlushEvent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tstamp::Queue::DoFlushEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="clasststamp_1_1_diagnostics.html">tstamp::Diagnostics</a> *&#160;</td>
          <td class="paramname"><em>diagnostics</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal helper function for flushing routines. </p>
<p>Call <a class="el" href="clasststamp_1_1_queue.html#afba5a1454d0e23085b6dc21b3a8af394" title="Erase the earliest event in the queue, first searching for coincidences. ">Pop()</a> on the front event</p>
<p>Update diagnostic info if diagnostics != NULL </p>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8cxx_source.html#l00175">175</a> of file <a class="el" href="_t_stamp_8cxx_source.html">TStamp.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">  /// Call Pop() on the front event</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span>  int32_t singlesId = -1;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordtype">bool</span> haveCoinc = <span class="keyword">false</span>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  uint32_t tfirst = <a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.rbegin()-&gt;GetTimeStamp();</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="clasststamp_1_1_queue.html#afba5a1454d0e23085b6dc21b3a8af394">Pop</a>(singlesId, haveCoinc);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">  /// Update diagnostic info if diagnostics != NULL</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(diagnostics) {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="clasststamp_1_1_queue.html#ac6ed4bc00093c9f4a76ca3370fdd140d">FillDiagnostics</a>(diagnostics, 0., haveCoinc, singlesId, tfirst);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="clasststamp_1_1_queue.html#a36d9414fe16b9c6ad4ff6e2338fe9e4b">HandleDiagnostics</a>(diagnostics);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div><div class="ttc" id="clasststamp_1_1_queue_html_a356a54b6e6714830e4e124da0c6c2d6b"><div class="ttname"><a href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">tstamp::Queue::fEvents</a></div><div class="ttdeci">MultiSet_t fEvents</div><div class="ttdoc">Internal container of events waiting to be matched. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8hxx_source.html#l00064">TStamp.hxx:64</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_afba5a1454d0e23085b6dc21b3a8af394"><div class="ttname"><a href="clasststamp_1_1_queue.html#afba5a1454d0e23085b6dc21b3a8af394">tstamp::Queue::Pop</a></div><div class="ttdeci">virtual void Pop(int32_t &amp;singles_id, bool &amp;found_coinc)</div><div class="ttdoc">Erase the earliest event in the queue, first searching for coincidences. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8cxx_source.html#l00107">TStamp.cxx:107</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_ac6ed4bc00093c9f4a76ca3370fdd140d"><div class="ttname"><a href="clasststamp_1_1_queue.html#ac6ed4bc00093c9f4a76ca3370fdd140d">tstamp::Queue::FillDiagnostics</a></div><div class="ttdeci">void FillDiagnostics(tstamp::Diagnostics *d, double tdiff, bool have_coinc, int32_t singles_id, uint32_t evt_time)</div><div class="ttdoc">Fill diagnostic information after a push. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8cxx_source.html#l00203">TStamp.cxx:203</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_a36d9414fe16b9c6ad4ff6e2338fe9e4b"><div class="ttname"><a href="clasststamp_1_1_queue.html#a36d9414fe16b9c6ad4ff6e2338fe9e4b">tstamp::Queue::HandleDiagnostics</a></div><div class="ttdeci">virtual void HandleDiagnostics(tstamp::Diagnostics *diagnostics) const</div><div class="ttdoc">What to do with a diagnostics event. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8cxx_source.html#l00035">TStamp.cxx:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a11624971fcc3d9670cf485c9a0be51a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11624971fcc3d9670cf485c9a0be51a3">&#9670;&nbsp;</a></span>Flush()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tstamp::Queue::Flush </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_time</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clasststamp_1_1_diagnostics.html">tstamp::Diagnostics</a> *&#160;</td>
          <td class="paramname"><em>diagnostics</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flush all events from the queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">max_time</td><td>Maximum of amount of time (in seconds) to spend clearing the queue before returning. Any unhandled events at the end of the time limit will simply be deleted. Default value (-1) blocks indefinitely until all events are emptied from the queue. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diagnostics</td><td>Optional pointer to a <a class="el" href="clasststamp_1_1_diagnostics.html" title="Class to store diagnostic information about coincidence matching. ">Diagnostics</a> class instance, to be filled with information from the flushed event</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8cxx_source.html#l00139">139</a> of file <a class="el" href="_t_stamp_8cxx_source.html">TStamp.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">  /*!</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">   * \param max_time Maximum of amount of time (in seconds) to spend clearing the</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">   *  queue before returning. Any unhandled events at the end of the time limit will</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">   *  simply be deleted. Default value (-1) blocks indefinitely until all events are</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">   *  emptied from the queue.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">   * \param [in] diagnostics Optional pointer to a Diagnostics class instance,</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">   *  to be filled with information from the flushed event</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  time_t t_begin = time(0);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.empty()) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> ( max_time &lt; 0 || (difftime(time(0), t_begin) &lt; max_time) ) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <a class="code" href="clasststamp_1_1_queue.html#a6df95dcf3177a513205eaa8695c21be4">DoFlushEvent</a>(diagnostics);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <a class="code" href="clasststamp_1_1_queue.html#a6cc3b5b6a85fab7ed0cf69a5ed328c98">FlushTimeoutMessage</a>(max_time);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.clear();</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div><div class="ttc" id="clasststamp_1_1_queue_html_a356a54b6e6714830e4e124da0c6c2d6b"><div class="ttname"><a href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">tstamp::Queue::fEvents</a></div><div class="ttdeci">MultiSet_t fEvents</div><div class="ttdoc">Internal container of events waiting to be matched. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8hxx_source.html#l00064">TStamp.hxx:64</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_a6df95dcf3177a513205eaa8695c21be4"><div class="ttname"><a href="clasststamp_1_1_queue.html#a6df95dcf3177a513205eaa8695c21be4">tstamp::Queue::DoFlushEvent</a></div><div class="ttdeci">void DoFlushEvent(tstamp::Diagnostics *)</div><div class="ttdoc">Internal helper function for flushing routines. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8cxx_source.html#l00175">TStamp.cxx:175</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_a6cc3b5b6a85fab7ed0cf69a5ed328c98"><div class="ttname"><a href="clasststamp_1_1_queue.html#a6cc3b5b6a85fab7ed0cf69a5ed328c98">tstamp::Queue::FlushTimeoutMessage</a></div><div class="ttdeci">virtual void FlushTimeoutMessage(int max_time) const</div><div class="ttdoc">Prints a message telling that Flush() timeout has been reached. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8cxx_source.html#l00190">TStamp.cxx:190</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab85c4725ac0a13ae9dfcabb7f3cfeef4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab85c4725ac0a13ae9dfcabb7f3cfeef4">&#9670;&nbsp;</a></span>FlushIterative()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t tstamp::Queue::FlushIterative </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="clasststamp_1_1_diagnostics.html">tstamp::Diagnostics</a> *&#160;</td>
          <td class="paramname"><em>diagnostics</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flush a single event from the queue. </p>
<p>"Iterative" or step-by-step flushing methos for users who perfer to flush the queue using their own external loop. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">diagnostics</td><td>Optional pointer to a <a class="el" href="clasststamp_1_1_diagnostics.html" title="Class to store diagnostic information about coincidence matching. ">Diagnostics</a> class instance, to be filled with information from the flushed event </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the internal queue <em>before</em> performing a flush.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8cxx_source.html#l00161">161</a> of file <a class="el" href="_t_stamp_8cxx_source.html">TStamp.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">  /*!</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">   * &quot;Iterative&quot; or step-by-step flushing methos for users who perfer to flush</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">   *  the queue using their own external loop.</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">   * \param [in] diagnostics Optional pointer to a Diagnostics class instance,</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">   *  to be filled with information from the flushed event</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">   * \returns The size of the internal queue \e before performing a flush.</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordtype">size_t</span> qsize = <a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.size();</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">if</span>(qsize &gt; 0) <a class="code" href="clasststamp_1_1_queue.html#a6df95dcf3177a513205eaa8695c21be4">DoFlushEvent</a>(diagnostics);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">return</span> qsize;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div><div class="ttc" id="clasststamp_1_1_queue_html_a356a54b6e6714830e4e124da0c6c2d6b"><div class="ttname"><a href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">tstamp::Queue::fEvents</a></div><div class="ttdeci">MultiSet_t fEvents</div><div class="ttdoc">Internal container of events waiting to be matched. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8hxx_source.html#l00064">TStamp.hxx:64</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_a6df95dcf3177a513205eaa8695c21be4"><div class="ttname"><a href="clasststamp_1_1_queue.html#a6df95dcf3177a513205eaa8695c21be4">tstamp::Queue::DoFlushEvent</a></div><div class="ttdeci">void DoFlushEvent(tstamp::Diagnostics *)</div><div class="ttdoc">Internal helper function for flushing routines. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8cxx_source.html#l00175">TStamp.cxx:175</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cc3b5b6a85fab7ed0cf69a5ed328c98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cc3b5b6a85fab7ed0cf69a5ed328c98">&#9670;&nbsp;</a></span>FlushTimeoutMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tstamp::Queue::FlushTimeoutMessage </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_time</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prints a message telling that <a class="el" href="clasststamp_1_1_queue.html#a11624971fcc3d9670cf485c9a0be51a3" title="Flush all events from the queue. ">Flush()</a> timeout has been reached. </p>
<p>Derived classes may wish to override this method to make use of a local message handling system (e.g. cm_msg() in MIDAS).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">max_time</td><td>Length of max <a class="el" href="clasststamp_1_1_queue.html#a11624971fcc3d9670cf485c9a0be51a3" title="Flush all events from the queue. ">Flush()</a> timeout in seconds</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8cxx_source.html#l00190">190</a> of file <a class="el" href="_t_stamp_8cxx_source.html">TStamp.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">  /*!</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">   * Derived classes may wish to override this method to make use of a local</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">   * message handling system (e.g. cm_msg() in MIDAS).</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">   * \param max_time Length of max Flush() timeout in seconds</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="code" href="classdragon_1_1utils_1_1_warning.html">dragon::utils::Warning</a>(<span class="stringliteral">&quot;tstamp::Queue::Flush()&quot;</span>, __FILE__, __LINE__)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Maximum timeout of &quot;</span> &lt;&lt; max_time &lt;&lt; <span class="stringliteral">&quot; seconds reached. Clearing event queue (skipping &quot;</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    &lt;&lt; <a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.size() &lt;&lt; <span class="stringliteral">&quot; events...).&quot;</span>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div><div class="ttc" id="clasststamp_1_1_queue_html_a356a54b6e6714830e4e124da0c6c2d6b"><div class="ttname"><a href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">tstamp::Queue::fEvents</a></div><div class="ttdeci">MultiSet_t fEvents</div><div class="ttdoc">Internal container of events waiting to be matched. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8hxx_source.html#l00064">TStamp.hxx:64</a></div></div>
<div class="ttc" id="classdragon_1_1utils_1_1_warning_html"><div class="ttname"><a href="classdragon_1_1utils_1_1_warning.html">dragon::utils::Warning</a></div><div class="ttdoc">Specialized Strm class to print warning messages. </div><div class="ttdef"><b>Definition:</b> <a href="_error_dragon_8hxx_source.html#l00214">ErrorDragon.hxx:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ed9b6d449f71b176b2e2e4048f41829"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ed9b6d449f71b176b2e2e4048f41829">&#9670;&nbsp;</a></span>HandleCoinc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tstamp::Queue::HandleCoinc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmidas_1_1_event.html">midas::Event</a> &amp;&#160;</td>
          <td class="paramname"><em>e1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmidas_1_1_event.html">midas::Event</a> &amp;&#160;</td>
          <td class="paramname"><em>e2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>What to do in case of a coincidence event. </p>
<p>In the base class, simply prints information about both events together. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">event1</td><td>Reference to the first coincident event. </td></tr>
    <tr><td class="paramname">event2</td><td>Reference to the second coincident event.</td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="clasststamp_1_1_owned_queue.html#af8ff723c355804d3f299261e17e3811f">tstamp::OwnedQueue&lt; T &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8cxx_source.html#l00015">15</a> of file <a class="el" href="_t_stamp_8cxx_source.html">TStamp.cxx</a>.</p>

<p class="reference">References <a class="el" href="_event_8cxx_source.html#l00128">midas::Event::PrintCoinc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">  /*!</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">   * In the base class, simply prints information about both events together.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">   * \param event1 Reference to the first coincident event.</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">   * \param event2 Reference to the second coincident event.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  event1.PrintCoinc(event2);</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="clasststamp_1_1_queue_a7ed9b6d449f71b176b2e2e4048f41829_cgraph.png" border="0" usemap="#clasststamp_1_1_queue_a7ed9b6d449f71b176b2e2e4048f41829_cgraph" alt=""/></div>
<map name="clasststamp_1_1_queue_a7ed9b6d449f71b176b2e2e4048f41829_cgraph" id="clasststamp_1_1_queue_a7ed9b6d449f71b176b2e2e4048f41829_cgraph">
<area shape="rect" id="node2" href="classmidas_1_1_event.html#aeaa22c36ed1e622725d574ce9822ed7a" title="Prints timestamp information for coincidence events. " alt="" coords="246,5,413,31"/>
</map>
</div>

</div>
</div>
<a id="a36d9414fe16b9c6ad4ff6e2338fe9e4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36d9414fe16b9c6ad4ff6e2338fe9e4b">&#9670;&nbsp;</a></span>HandleDiagnostics()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tstamp::Queue::HandleDiagnostics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="clasststamp_1_1_diagnostics.html">tstamp::Diagnostics</a> *&#160;</td>
          <td class="paramname"><em>diagnostics</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>What to do with a diagnostics event. </p>
<p>In the base class, prints diagnostic fields.</p>

<p>Reimplemented in <a class="el" href="clasststamp_1_1_owned_queue.html#a84778338b729ba640849f74204c9e3e2">tstamp::OwnedQueue&lt; T &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8cxx_source.html#l00035">35</a> of file <a class="el" href="_t_stamp_8cxx_source.html">TStamp.cxx</a>.</p>

<p class="reference">References <a class="el" href="_t_stamp_8hxx_source.html#l00212">tstamp::Diagnostics::MAX_TYPES</a>, <a class="el" href="_t_stamp_8hxx_source.html#l00218">tstamp::Diagnostics::n_coinc</a>, <a class="el" href="_t_stamp_8hxx_source.html#l00225">tstamp::Diagnostics::n_singles</a>, <a class="el" href="_t_stamp_8hxx_source.html#l00215">tstamp::Diagnostics::size</a>, and <a class="el" href="_t_stamp_8hxx_source.html#l00234">tstamp::Diagnostics::time_diff</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">  /*!</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">   * In the base class, prints diagnostic fields.</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="classdragon_1_1utils_1_1_info.html">dragon::utils::Info</a>(<span class="stringliteral">&quot;tstamp::Queue&quot;</span>, __FILE__, __LINE__)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Diagnostics event: size = &quot;</span> &lt;&lt; d-&gt;size &lt;&lt; <span class="stringliteral">&quot;, n_coinc = &quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    &lt;&lt; d-&gt;n_coinc &lt;&lt; <span class="stringliteral">&quot;, time_diff = &quot;</span> &lt;&lt; d-&gt;time_diff &lt;&lt; <span class="stringliteral">&quot;, n_singles[]: &quot;</span>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; <a class="code" href="clasststamp_1_1_diagnostics.html#a4d8a7f3be6d6d819bd24bc5451e4702f">tstamp::Diagnostics::MAX_TYPES</a>; ++i) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;]: &quot;</span> &lt;&lt; d-&gt;n_singles[i] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div><div class="ttc" id="classdragon_1_1utils_1_1_info_html"><div class="ttname"><a href="classdragon_1_1utils_1_1_info.html">dragon::utils::Info</a></div><div class="ttdoc">Specialized Strm class to print informational messages. </div><div class="ttdef"><b>Definition:</b> <a href="_error_dragon_8hxx_source.html#l00140">ErrorDragon.hxx:140</a></div></div>
<div class="ttc" id="clasststamp_1_1_diagnostics_html_a4d8a7f3be6d6d819bd24bc5451e4702f"><div class="ttname"><a href="clasststamp_1_1_diagnostics.html#a4d8a7f3be6d6d819bd24bc5451e4702f">tstamp::Diagnostics::MAX_TYPES</a></div><div class="ttdeci">static const int32_t MAX_TYPES</div><div class="ttdoc">Maximum number of event types (ids) allowable. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8hxx_source.html#l00212">TStamp.hxx:212</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5391a0145cdd9899bebe790e8abecf9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5391a0145cdd9899bebe790e8abecf9f">&#9670;&nbsp;</a></span>HandleSingle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tstamp::Queue::HandleSingle </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmidas_1_1_event.html">midas::Event</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>What to do in case of a singles event. </p>
<p>In the base class, simply prints information on the event. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">event</td><td>Reference to the event being handled.</td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="clasststamp_1_1_owned_queue.html#a14e3b58a2c24b7f05ae53a3621d23715">tstamp::OwnedQueue&lt; T &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8cxx_source.html#l00026">26</a> of file <a class="el" href="_t_stamp_8cxx_source.html">TStamp.cxx</a>.</p>

<p class="reference">References <a class="el" href="_event_8cxx_source.html#l00120">midas::Event::PrintSingle()</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">  /*!</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">   * In the base class, simply prints information on the event.</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">   * \param event Reference to the event being handled.</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  e.PrintSingle();</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;}</div></div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="clasststamp_1_1_queue_a5391a0145cdd9899bebe790e8abecf9f_cgraph.png" border="0" usemap="#clasststamp_1_1_queue_a5391a0145cdd9899bebe790e8abecf9f_cgraph" alt=""/></div>
<map name="clasststamp_1_1_queue_a5391a0145cdd9899bebe790e8abecf9f_cgraph" id="clasststamp_1_1_queue_a5391a0145cdd9899bebe790e8abecf9f_cgraph">
<area shape="rect" id="node2" href="classmidas_1_1_event.html#a41b921638e2d73f0e0a37115671d5e5e" title="Prints timestamp information for a singles event. " alt="" coords="249,5,419,31"/>
</map>
</div>

</div>
</div>
<a id="afba5a1454d0e23085b6dc21b3a8af394"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afba5a1454d0e23085b6dc21b3a8af394">&#9670;&nbsp;</a></span>Pop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tstamp::Queue::Pop </td>
          <td>(</td>
          <td class="paramtype">int32_t &amp;&#160;</td>
          <td class="paramname"><em>singles_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>found_coinc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Erase the earliest event in the queue, first searching for coincidences. </p>
<p>Looks at the earliest event still in the queue and searches for all other events in the queue with trigger times within the trigger window. Then the function loops over each of the matches and calls <a class="el" href="clasststamp_1_1_queue.html#a7ed9b6d449f71b176b2e2e4048f41829" title="What to do in case of a coincidence event. ">HandleCoinc()</a> on the two events. Finally, the function calls <a class="el" href="clasststamp_1_1_queue.html#a5391a0145cdd9899bebe790e8abecf9f" title="What to do in case of a singles event. ">HandleSingle()</a> on the earliest event and then deletes it from the queue.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">singles_id</td><td>MIDAS event ID of the removed (handled) singles event. A return value of -1 means the queue was empty (no event handled). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">found_coinc</td><td>Set to true if a coincidence match was found, false otherwise.</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8cxx_source.html#l00107">107</a> of file <a class="el" href="_t_stamp_8cxx_source.html">TStamp.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">  /*!</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">   * Looks at the earliest event still in the queue and searches for</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">   * all other events in the queue with trigger times within the trigger window.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">   * Then the function loops over each of the matches and calls HandleCoinc() on</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">   * the two events. Finally, the function calls HandleSingle() on the earliest</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">   * event and then deletes it from the queue.</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">   * \param [out] singles_id MIDAS event ID of the removed (handled) singles event.</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">   * A return value of -1 means the queue was empty (no event handled).</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">   * \param [out] found_coinc Set to true if a coincidence match was found, false</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">   *  otherwise.</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  singles_id = -1;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  found_coinc = <span class="keyword">false</span>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.empty()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="clasststamp_1_1_queue.html#acafa71d2f1230b246a9b21e00576786d">EqualRange_t</a> matches = <a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.equal_range(*<a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.begin());</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  MultiSet_t::iterator itMatch;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">for</span> (itMatch = matches.first; itMatch != matches.second; ++itMatch) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">if</span> (itMatch != <a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.begin()) {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      found_coinc = <span class="keyword">true</span>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="clasststamp_1_1_queue.html#a7ed9b6d449f71b176b2e2e4048f41829">HandleCoinc</a>(*<a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.begin(), *itMatch);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  singles_id = <a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.begin()-&gt;GetEventId();</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="clasststamp_1_1_queue.html#a5391a0145cdd9899bebe790e8abecf9f">HandleSingle</a>(*<a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.begin());</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.erase(<a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.begin());</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;}</div><div class="ttc" id="clasststamp_1_1_queue_html_a356a54b6e6714830e4e124da0c6c2d6b"><div class="ttname"><a href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">tstamp::Queue::fEvents</a></div><div class="ttdeci">MultiSet_t fEvents</div><div class="ttdoc">Internal container of events waiting to be matched. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8hxx_source.html#l00064">TStamp.hxx:64</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_acafa71d2f1230b246a9b21e00576786d"><div class="ttname"><a href="clasststamp_1_1_queue.html#acafa71d2f1230b246a9b21e00576786d">tstamp::Queue::EqualRange_t</a></div><div class="ttdeci">std::pair&lt; MultiSet_t::iterator, MultiSet_t::iterator &gt; EqualRange_t</div><div class="ttdoc">Pair of MultiSet_t iterators, returned from std::multiset::equal_range() </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8hxx_source.html#l00057">TStamp.hxx:57</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_a7ed9b6d449f71b176b2e2e4048f41829"><div class="ttname"><a href="clasststamp_1_1_queue.html#a7ed9b6d449f71b176b2e2e4048f41829">tstamp::Queue::HandleCoinc</a></div><div class="ttdeci">virtual void HandleCoinc(const midas::Event &amp;e1, const midas::Event &amp;e2) const</div><div class="ttdoc">What to do in case of a coincidence event. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8cxx_source.html#l00015">TStamp.cxx:15</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_a5391a0145cdd9899bebe790e8abecf9f"><div class="ttname"><a href="clasststamp_1_1_queue.html#a5391a0145cdd9899bebe790e8abecf9f">tstamp::Queue::HandleSingle</a></div><div class="ttdeci">virtual void HandleSingle(const midas::Event &amp;event) const</div><div class="ttdoc">What to do in case of a singles event. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8cxx_source.html#l00026">TStamp.cxx:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aec131fb4adef03e358ac57e7bb39118b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec131fb4adef03e358ac57e7bb39118b">&#9670;&nbsp;</a></span>Push()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tstamp::Queue::Push </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmidas_1_1_event.html">midas::Event</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clasststamp_1_1_diagnostics.html">tstamp::Diagnostics</a> *&#160;</td>
          <td class="paramname"><em>diagnostics</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Insert an element into the queue. </p>
<p>First the function inserts <em>event</em> into the internal container. Then, it calls <a class="el" href="clasststamp_1_1_queue.html#afba5a1454d0e23085b6dc21b3a8af394" title="Erase the earliest event in the queue, first searching for coincidences. ">Pop()</a> until the container size (time difference) is no longer larger than the maximum. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event</td><td>Event to insert into the queue. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diagnostics</td><td>Optional pointer to a <a class="el" href="clasststamp_1_1_diagnostics.html" title="Class to store diagnostic information about coincidence matching. ">Diagnostics</a> class instance, to be filled with information from the push </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function does attempt to handle exceptions thrown by the std::multiset::insert() function. Most likely these would result from making the set size too large, so we empty the queue and try again (w/ error mesage). If it still fails, give up and rethrow the exception (causing program termination). If other exceptions start to show up, then code shold be added to handle them gracefully.</dd></dl>
<p>Update diagnostic info in diagnostics != NULL </p>

<p class="definition">Definition at line <a class="el" href="_t_stamp_8cxx_source.html#l00049">49</a> of file <a class="el" href="_t_stamp_8cxx_source.html">TStamp.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">  /*!</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">   * First the function inserts \e event into the internal container. Then,</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">   * it calls Pop() until the container size (time difference) is no longer</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">   * larger than the maximum.</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">   * \param [in] event Event to insert into the queue.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">   * \param [in] diagnostics Optional pointer to a Diagnostics class instance,</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">   *  to be filled with information from the push</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">   * \note The function does attempt to handle exceptions thrown by the</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">   * std::multiset::insert() function. Most likely these would result from</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">   * making the set size too large, so we empty the queue and try again</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">   * (w/ error mesage). If it still fails, give up and rethrow the exception</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">   * (causing program termination).  If other exceptions start to show up, then</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">   * code shold be added to handle them gracefully.</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">try</span> { <span class="comment">// insert event into the queue</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.insert(event);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">catch</span> (std::exception&amp; e) { <span class="comment">// try to handle exception gracefully</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="classdragon_1_1utils_1_1_error.html">dragon::utils::Error</a>(<span class="stringliteral">&quot;tstamp::Queue::Push&quot;</span>, __FILE__, __LINE__)</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Caught an exception from std::multiset::insert: &quot;</span> &lt;&lt; e.what()</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; (note: size = &quot;</span> &lt;&lt; <a class="code" href="clasststamp_1_1_queue.html#a8dd183e4250893a7525f0e81089cb640">Size</a>() &lt;&lt; <span class="stringliteral">&quot;, max size = &quot;</span> &lt;&lt; <a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.max_size()</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;). Clearing the Queue and trying again... WARNING: that this could cause &quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;coincidences to be missed!&quot;</span>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="clasststamp_1_1_queue.html#a11624971fcc3d9670cf485c9a0be51a3">Flush</a>(-1, diagnostics); <span class="comment">// remove everything from the queue</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">try</span> { <span class="comment">// try again to insert</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.insert(event);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">catch</span> (std::exception&amp; e) { <span class="comment">// give up</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="classdragon_1_1utils_1_1_error.html">dragon::utils::Error</a>(<span class="stringliteral">&quot;tstamp::Queue::Push&quot;</span>, __FILE__, __LINE__)</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Caught a second exception from std::multiset::insert: &quot;</span> &lt;&lt; e.what()</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;. Not sure what to do: rethrowing (likely fatal!)&quot;</span>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">throw</span> (e);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// Erase event from the front of the queue, but first collect some</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// diagnostic info</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  assert(<a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.size() &gt; 0);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">bool</span> haveCoinc = <span class="keyword">false</span>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  int32_t singlesId = -1;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">double</span> tdiff = <span class="keyword">event</span>.TimeDiff(*<a class="code" href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">fEvents</a>.begin());</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="clasststamp_1_1_queue.html#a227aaad40d758d1838ebea52389f715e">IsFull</a>()) <a class="code" href="clasststamp_1_1_queue.html#afba5a1454d0e23085b6dc21b3a8af394">Pop</a>(singlesId, haveCoinc);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">  /// Update diagnostic info in diagnostics != NULL</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span>(diagnostics) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="clasststamp_1_1_queue.html#ac6ed4bc00093c9f4a76ca3370fdd140d">FillDiagnostics</a>(diagnostics, tdiff, haveCoinc, singlesId, event.GetTimeStamp());</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="clasststamp_1_1_queue.html#a36d9414fe16b9c6ad4ff6e2338fe9e4b">HandleDiagnostics</a>(diagnostics);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="ttc" id="clasststamp_1_1_queue_html_a356a54b6e6714830e4e124da0c6c2d6b"><div class="ttname"><a href="clasststamp_1_1_queue.html#a356a54b6e6714830e4e124da0c6c2d6b">tstamp::Queue::fEvents</a></div><div class="ttdeci">MultiSet_t fEvents</div><div class="ttdoc">Internal container of events waiting to be matched. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8hxx_source.html#l00064">TStamp.hxx:64</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_afba5a1454d0e23085b6dc21b3a8af394"><div class="ttname"><a href="clasststamp_1_1_queue.html#afba5a1454d0e23085b6dc21b3a8af394">tstamp::Queue::Pop</a></div><div class="ttdeci">virtual void Pop(int32_t &amp;singles_id, bool &amp;found_coinc)</div><div class="ttdoc">Erase the earliest event in the queue, first searching for coincidences. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8cxx_source.html#l00107">TStamp.cxx:107</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_ac6ed4bc00093c9f4a76ca3370fdd140d"><div class="ttname"><a href="clasststamp_1_1_queue.html#ac6ed4bc00093c9f4a76ca3370fdd140d">tstamp::Queue::FillDiagnostics</a></div><div class="ttdeci">void FillDiagnostics(tstamp::Diagnostics *d, double tdiff, bool have_coinc, int32_t singles_id, uint32_t evt_time)</div><div class="ttdoc">Fill diagnostic information after a push. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8cxx_source.html#l00203">TStamp.cxx:203</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_a11624971fcc3d9670cf485c9a0be51a3"><div class="ttname"><a href="clasststamp_1_1_queue.html#a11624971fcc3d9670cf485c9a0be51a3">tstamp::Queue::Flush</a></div><div class="ttdeci">virtual void Flush(int max_time=-1, tstamp::Diagnostics *diagnostics=0)</div><div class="ttdoc">Flush all events from the queue. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8cxx_source.html#l00139">TStamp.cxx:139</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_a36d9414fe16b9c6ad4ff6e2338fe9e4b"><div class="ttname"><a href="clasststamp_1_1_queue.html#a36d9414fe16b9c6ad4ff6e2338fe9e4b">tstamp::Queue::HandleDiagnostics</a></div><div class="ttdeci">virtual void HandleDiagnostics(tstamp::Diagnostics *diagnostics) const</div><div class="ttdoc">What to do with a diagnostics event. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8cxx_source.html#l00035">TStamp.cxx:35</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_a8dd183e4250893a7525f0e81089cb640"><div class="ttname"><a href="clasststamp_1_1_queue.html#a8dd183e4250893a7525f0e81089cb640">tstamp::Queue::Size</a></div><div class="ttdeci">size_t Size() const</div><div class="ttdoc">Returns total number of entries in the queue. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8hxx_source.html#l00096">TStamp.hxx:96</a></div></div>
<div class="ttc" id="clasststamp_1_1_queue_html_a227aaad40d758d1838ebea52389f715e"><div class="ttname"><a href="clasststamp_1_1_queue.html#a227aaad40d758d1838ebea52389f715e">tstamp::Queue::IsFull</a></div><div class="ttdeci">bool IsFull() const</div><div class="ttdoc">Check whether the maximum size has been reached. </div><div class="ttdef"><b>Definition:</b> <a href="_t_stamp_8hxx_source.html#l00112">TStamp.hxx:112</a></div></div>
<div class="ttc" id="classdragon_1_1utils_1_1_error_html"><div class="ttname"><a href="classdragon_1_1utils_1_1_error.html">dragon::utils::Error</a></div><div class="ttdoc">Specialized Strm class to print error messages. </div><div class="ttdef"><b>Definition:</b> <a href="_error_dragon_8hxx_source.html#l00177">ErrorDragon.hxx:177</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Volumes/Data/Users/elzoido238/packages/dragon/analyzer/src/<a class="el" href="_t_stamp_8hxx_source.html">TStamp.hxx</a></li>
<li>/Volumes/Data/Users/elzoido238/packages/dragon/analyzer/src/<a class="el" href="_t_stamp_8cxx_source.html">TStamp.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Sep 25 2018 14:13:58 for DRAGON Analyzer by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
